{
  "version": "001",
  "name": "initial_schema",
  "description": "初始数据库结构",
  "created_at": "2024-01-01T00:00:00Z",
  "sql": [
    {
      "up": [
        "CREATE TABLE IF NOT EXISTS users (",
        "  id INTEGER PRIMARY KEY AUTOINCREMENT,",
        "  username VARCHAR(50) UNIQUE NOT NULL,",
        "  email VARCHAR(100) UNIQUE NOT NULL,",
        "  password_hash VARCHAR(255) NOT NULL,",
        "  role VARCHAR(20) DEFAULT 'user',",
        "  status VARCHAR(20) DEFAULT 'active',",
        "  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,",
        "  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP",
        ");",
        "",
        "CREATE TABLE IF NOT EXISTS articles (",
        "  id INTEGER PRIMARY KEY AUTOINCREMENT,",
        "  title VARCHAR(200) NOT NULL,",
        "  slug VARCHAR(200) UNIQUE NOT NULL,",
        "  content TEXT,",
        "  excerpt TEXT,",
        "  author_id INTEGER,",
        "  status VARCHAR(20) DEFAULT 'draft',",
        "  published_at DATETIME,",
        "  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,",
        "  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,",
        "  FOREIGN KEY (author_id) REFERENCES users(id)",
        ");",
        "",
        "CREATE TABLE IF NOT EXISTS media (",
        "  id INTEGER PRIMARY KEY AUTOINCREMENT,",
        "  filename VARCHAR(255) NOT NULL,",
        "  original_name VARCHAR(255) NOT NULL,",
        "  file_path VARCHAR(500) NOT NULL,",
        "  file_size INTEGER NOT NULL,",
        "  mime_type VARCHAR(100) NOT NULL,",
        "  uploaded_by INTEGER,",
        "  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,",
        "  FOREIGN KEY (uploaded_by) REFERENCES users(id)",
        ");",
        "",
        "CREATE TABLE IF NOT EXISTS settings (",
        "  id INTEGER PRIMARY KEY AUTOINCREMENT,",
        "  key VARCHAR(100) UNIQUE NOT NULL,",
        "  value TEXT,",
        "  description TEXT,",
        "  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,",
        "  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP",
        ");",
        "",
        "CREATE TABLE IF NOT EXISTS logs (",
        "  id INTEGER PRIMARY KEY AUTOINCREMENT,",
        "  level VARCHAR(20) NOT NULL,",
        "  message TEXT NOT NULL,",
        "  context TEXT,",
        "  user_id INTEGER,",
        "  ip_address VARCHAR(45),",
        "  user_agent TEXT,",
        "  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,",
        "  FOREIGN KEY (user_id) REFERENCES users(id)",
        ");"
      ],
      "down": [
        "DROP TABLE IF EXISTS logs;",
        "DROP TABLE IF EXISTS settings;",
        "DROP TABLE IF EXISTS media;",
        "DROP TABLE IF EXISTS articles;",
        "DROP TABLE IF EXISTS users;"
      ]
    }
  ],
  "dependencies": [],
  "checksum": "sha256:abc123def456..."
} 